---
title: "analysis1"
author: "Sridhar"
date: "4 February 2018"
output: html_document
---

```{r}
library("ggplot2")
library("corrplot")
library("caret")
library("e1071")
library("class")
```

## Including the dataset

```{r}
train <- read.csv("train.csv",stringsAsFactors = F)
test <- read.csv("test.csv",stringsAsFactors = F)
```

## What the data has

```{r}
head(train)
```
```{r}
str(train)
```
Variable    Name	Description
Survived	  Survived (1) or died (0)
Pclass	    Passenger’s class
Name	      Passenger’s name
Sex	        Passenger’s sex
Age	        Passenger’s age
SibSp	      Number of siblings/spouses aboard
Parch	      Number of parents/children aboard
Ticket	    Ticket number
Fare	      Fare
Cabin	      Cabin
Embarked	  Port of embarkation

## Clean it
```{r}
##train <- na.omit(train)
##test <- na.omit(test)
```
## Age influence
```{r}
table(train$Survived,train$Sex)
```


```{r}
ggplot(aes(Age,as.numeric(Survived), color=Sex),data = train) + geom_point(position=position_jitter(height=0.03, width=0)) +
  stat_smooth(method="glm", family=binomial, formula=y~x,
alpha=0.2, size=2, aes(fill=Sex)) 
```


## Age relations - Sounds insane!

```{r}
cor.test(train$Survived,train$Age)
```
```{r}
num_train <- train[,sapply(train, is.numeric)]
num_test <- test[,sapply(test, is.numeric)]
cm <-cor(num_train)
```

```{r}
corrplot(cm,method = "shade")
```
Survived is correlated with Fare
```{r}
table(train$Survived)
```

```{r}
qplot(Fare,data = train)
```

```{r}
high_fare = subset(train,train$Fare > 500)
high_fare$Survived
```
As predicted the people who pain high fare for the journey are survived,as per correlation

## Analysis

Male death is higher than female

```{r}

train %>% ggvis(~Age,~Sex,fill = ~Survived) %>% layer_points()
```


```{r}
train %>% ggvis(~Pclass,~Survived) %>% layer_points()
```

3rd class in PClass has high survival


```{r}
train %>% ggvis(~Age,~Survived) %>% layer_histograms()
```

